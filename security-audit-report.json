{
  "timestamp": "2025-06-03T06:13:34.779Z",
  "scannedFiles": 168,
  "totalIssues": 44,
  "issuesBySeverity": {
    "high": 7,
    "medium": 37,
    "low": 0
  },
  "issues": [
    {
      "file": "F:\\WhatsappAutomation\\.netlify\\functions-serve\\.unzipped\\clients-import\\netlify\\functions\\clients-import.js",
      "line": 5741,
      "issue": "Environment variable WS_NO_BUFFER_UTIL used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:30.199Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\.netlify\\functions-serve\\.unzipped\\clients-import\\netlify\\functions\\clients-import.js",
      "line": 6386,
      "issue": "Environment variable WS_NO_UTF_ used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:30.199Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\.netlify\\functions-serve\\.unzipped\\clients-import\\netlify\\functions\\clients-import.js",
      "line": 14864,
      "issue": "Environment variable NEXT_PUBLIC_SUPABASE_URL used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:30.209Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\.netlify\\functions-serve\\.unzipped\\clients-import\\netlify\\functions\\clients-import.js",
      "line": 14865,
      "issue": "Environment variable NEXT_PUBLIC_SUPABASE_ANON_KEY used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:30.209Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\jest.setup.js",
      "line": 44,
      "issue": "Environment variable NEXT_PUBLIC_SUPABASE_URL used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:30.273Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\jest.setup.js",
      "line": 45,
      "issue": "Environment variable NEXT_PUBLIC_SUPABASE_ANON_KEY used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:30.273Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\netlify\\functions\\clients-import.js",
      "line": 32,
      "issue": "Environment variable NEXT_PUBLIC_SUPABASE_URL used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:30.274Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\netlify\\functions\\clients-import.js",
      "line": 33,
      "issue": "Environment variable NEXT_PUBLIC_SUPABASE_ANON_KEY used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:30.274Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\netlify\\functions\\send-scheduled-messages.js",
      "line": 29,
      "issue": "Environment variable NEXT_PUBLIC_SUPABASE_URL used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:30.275Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\playwright.config.ts",
      "line": 11,
      "issue": "Environment variable CI used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.648Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\playwright.config.ts",
      "line": 13,
      "issue": "Environment variable CI used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.648Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\playwright.config.ts",
      "line": 15,
      "issue": "Environment variable CI used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.648Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\playwright.config.ts",
      "line": 79,
      "issue": "Environment variable CI used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.648Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\scripts\\security-audit.js",
      "line": 117,
      "issue": "Potential XSS vulnerability detected",
      "severity": "high",
      "timestamp": "2025-06-03T06:13:34.653Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\app\\api\\brands\\route.ts",
      "line": 8,
      "issue": "Environment variable NEXT_PUBLIC_SUPABASE_URL used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.664Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\app\\api\\brands\\route.ts",
      "line": 9,
      "issue": "Environment variable SUPABASE_SERVICE_ROLE_KEY used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.664Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\app\\api\\content\\generate\\route.ts",
      "line": 6,
      "issue": "Environment variable NEXT_PUBLIC_SUPABASE_URL used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.669Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\app\\api\\content\\generate\\route.ts",
      "line": 7,
      "issue": "Environment variable SUPABASE_SERVICE_ROLE_KEY used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.669Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\app\\api\\content\\generate\\route.ts",
      "line": 135,
      "issue": "Potential SQL injection vulnerability detected",
      "severity": "high",
      "timestamp": "2025-06-03T06:13:34.669Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\app\\api\\telegram\\webhook\\route.ts",
      "line": 243,
      "issue": "Environment variable TELEGRAM_WEBHOOK_TOKEN used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.681Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\app\\api\\telegram\\webhook-ai\\route.ts",
      "line": 46,
      "issue": "Environment variable TELEGRAM_BOT_TOKEN used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.682Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\app\\api\\whatsapp\\webhook\\route.ts",
      "line": 4,
      "issue": "Environment variable WHATSAPP_VERIFY_TOKEN used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.685Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\components\\teams\\team-activity.tsx",
      "line": 99,
      "issue": "Potential SQL injection vulnerability detected",
      "severity": "high",
      "timestamp": "2025-06-03T06:13:34.720Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\components\\teams\\team-activity.tsx",
      "line": 101,
      "issue": "Potential SQL injection vulnerability detected",
      "severity": "high",
      "timestamp": "2025-06-03T06:13:34.720Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\lib\\ai-agent-manager.ts",
      "line": 47,
      "issue": "Environment variable NEXT_PUBLIC_SUPABASE_URL used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.728Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\lib\\composio.ts",
      "line": 37,
      "issue": "Environment variable OPENAI_API_KEY used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.734Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\lib\\credentials.ts",
      "line": 4,
      "issue": "Environment variable NEXT_PUBLIC_SUPABASE_URL used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.735Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\lib\\credentials.ts",
      "line": 5,
      "issue": "Environment variable SUPABASE_SERVICE_ROLE_KEY used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.735Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\lib\\email\\invitation-service.ts",
      "line": 107,
      "issue": "Environment variable SENDGRID_API_KEY used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.735Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\lib\\email\\invitation-service.ts",
      "line": 110,
      "issue": "Environment variable RESEND_API_KEY used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.735Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\lib\\julep-client.ts",
      "line": 549,
      "issue": "Environment variable JULEP_BASE_URL used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.736Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\lib\\messaging\\manager.ts",
      "line": 15,
      "issue": "Environment variable TELEGRAM_BOT_TOKEN used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.737Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\lib\\messaging\\manager.ts",
      "line": 16,
      "issue": "Environment variable TELEGRAM_WEBHOOK_URL used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.737Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\lib\\security\\secure-credentials.ts",
      "line": 6,
      "issue": "Environment variable NEXT_PUBLIC_SUPABASE_URL used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.740Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\lib\\security\\secure-credentials.ts",
      "line": 7,
      "issue": "Environment variable SUPABASE_SERVICE_ROLE_KEY used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.740Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\lib\\supabase.ts",
      "line": 10,
      "issue": "Environment variable NEXT_PUBLIC_SUPABASE_URL used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.741Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\lib\\supabase.ts",
      "line": 11,
      "issue": "Environment variable SUPABASE_SERVICE_ROLE_KEY used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.741Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\lib\\whatsapp-enhanced.ts",
      "line": 48,
      "issue": "Environment variable NEXT_PUBLIC_SUPABASE_URL used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.743Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\lib\\whatsapp-enhanced.ts",
      "line": 49,
      "issue": "Environment variable SUPABASE_SERVICE_ROLE_KEY used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.743Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\lib\\whatsapp.ts",
      "line": 17,
      "issue": "Environment variable WHATSAPP_PHONE_ID used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.745Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\lib\\whatsapp.ts",
      "line": 18,
      "issue": "Environment variable WHATSAPP_ACCESS_TOKEN used without fallback or validation",
      "severity": "medium",
      "timestamp": "2025-06-03T06:13:34.745Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\src\\server\\jobs\\sendMessages.ts",
      "line": 93,
      "issue": "Potential SQL injection vulnerability detected",
      "severity": "high",
      "timestamp": "2025-06-03T06:13:34.745Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\test-connection.js",
      "line": 6,
      "issue": "Potential hardcoded secret or API key detected",
      "severity": "high",
      "timestamp": "2025-06-03T06:13:34.772Z"
    },
    {
      "file": "F:\\WhatsappAutomation\\test-webhook.js",
      "line": 3,
      "issue": "Potential hardcoded secret or API key detected",
      "severity": "high",
      "timestamp": "2025-06-03T06:13:34.775Z"
    }
  ]
}